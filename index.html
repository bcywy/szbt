<!doctype html>
<html>
  <head>
    <script>
      var legacy = false;
      try {
        legacy = !history.pushState || !window.Promise || !window.fetch || !String.prototype.includes || !Array.prototype.includes || !Object.entries;
        Function('class test{t(){const s=x=>x;for(let i of [...[]]);}}');
      } catch(e) {
        legacy = true;
      }
      if (legacy) {
        location.replace('sz3.legacy.html');
      }
    </script>
    <meta charset="utf-8">
    <meta name="theme-color" content="#5f8cb5">
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="icon" type="image/png" href="images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/x-icon" href="favicon.ico" sizes="16x16">
    <link rel="apple-touch-icon" href="images/szbus_192.png">
    <title>苏州公交</title>
    <style>
      body {
        font-size: 12pt;
      }

      .a_small_note {
        font-size: 9pt;
        text-decoration: none;
        display: inline-block;
      }

      #cellDetails {
        position: absolute;
        border: black solid 2px;
        padding: 8px;
        background-color: #f0e5a6;
        white-space: nowrap;
      }

      #updates {
        position: absolute;
        border: black solid 2px;
        height: 8em;
        overflow-y: scroll;
        background-color: #c8f9f9;
        white-space: nowrap;
      }

      #progress {
        margin-left: 3em;
        margin-right: 3em;
        border: black 3px solid;
      }

      #progressbar {
        background-color: #0000ff;
        height: 1.2em;
        width: 0;
      }
      
      #progress_text {
        position: absolute;
        left: 0;
        right: 0;
        text-align: center;
        white-space: nowrap;
      }

      #offline_prompt {
        background-color: #ff9999;
        border: red 4px solid;
        text-align: center;
        font-weight: bold;
      }

      #content table {
        border-spacing: 0;
      }

      #content th {
        white-space: nowrap;
        margin-left: 0.3ex;
        margin-right: 0.3ex;
      }

      #content table tbody td {
        vertical-align: top;
      }

      .busid_range_begin {
      }

      .busid_odd_range_element {
        background-color: #f0f080;
      }

      .busid_even_range_element {
        background-color: #c8f9f9;
      }

      .busid_range_end {
      }

      .date_holiday {
        background-color: #c9f9c8;
      }

      .date_incontinuous_below {
        border-bottom: 4px double black;
      }

      .line_view_bus_item {
        height: 100%;
        display: inline-block;
        text-align: center;
      }

      .line_legend_item {
        height: 1em;
        width: 2em;
        display: inline-block;
        margin-left: 2.5em;
      }
    </style>
    <script>function createElement(a,b,c){var d=document.createElement(a);appendChildren(d,b);for(const[e,f]of Object.entries(c||{}))if('style'==e&&'object'==typeof f)for(const[a,b]of Object.entries(f||{}))d.style[a]=b;else d.setAttribute('className'==e?'class':e,f);return d}function appendChildren(a,b,c){if(b)return'string'==typeof a&&(a=document.getElementById(a)),'string'==typeof b?a.appendChild(document.createTextNode(b)):(window.Node&&'object'==typeof window.Node?b instanceof window.Node:'object'==typeof b&&'number'==typeof b.nodeType&&'string'==typeof b.nodeName)?a.appendChild(b):b.length&&!c&&[].forEach.call(b,(b)=>appendChildren(a,b,!0)),a}function removeChildren(a){for('string'==typeof a&&(a=document.getElementById(a));a.hasChildNodes();)a.removeChild(a.childNodes[0])}function replaceChildren(a,b){'string'==typeof a&&(a=document.getElementById(a)),removeChildren(a),appendChildren(a,b)}function fillSelect(a,b,c){'string'==typeof a&&(a=document.getElementById(a)),removeChildren(a),b.forEach((b,d)=>{let e=document.createElement('option');e.value=c?c[d]||b:b,e.appendChild(document.createTextNode(b)),a.appendChild(e)})}
class DateUtils{static formatNumber_(a){let b=a.toString();return 1==b.length?'0'+b:b}static formatDate(a,b,c){let d=a.toString();return b&&(d+='-'+DateUtils.formatNumber_(b)),c&&(d+='-'+DateUtils.formatNumber_(c)),d}static toYearMonth(a){let b=a.indexOf('-');if(-1==b)return a;let c=a.indexOf('-',b+1);return-1==c?a:a.substr(0,c)}static nextMonth(a){let b=a.split('-').map((a)=>parseInt(a));return b[1]++,12<b[1]&&(b[0]+=Math.floor(b[1]/12),b[1]%=12),b[2]&&b[2]>DateUtils.daysInMonths(b[1])&&(b[2]=DateUtils.daysInMonths(b[1])),DateUtils.formatDate(...b)}static previousMonth(a){let b=a;return'string'==typeof a&&(b=a.split('-').map((a)=>parseInt(a))),b[1]--,0==b[1]&&(b[0]--,b[1]=12),b[2]&&b[2]>DateUtils.daysInMonths(b[1])&&(b[2]=DateUtils.daysInMonth(b[1])),DateUtils.formatDate(...b)}static yesterday(a){let b=a.split('-').map((a)=>parseInt(a));if(b[2]--,0==b[2]){let a=DateUtils.previousMonth(b.slice(0,2)),c=a.split('-').map((a)=>parseInt(a));return a+'-'+DateUtils.formatNumber_(DateUtils.daysInMonth(c[0],c[1]))}return DateUtils.formatDate(...b)}static tomorrow(a){let b=a.split('-').map((a)=>parseInt(a));return b[2]++,b[2]>DateUtils.daysInMonth(b[0],b[1])?DateUtils.nextMonth(DateUtils.formatDate(...b.slice(0,2)))+'-01':DateUtils.formatDate(...b)}static isLeapYear(a){return a=parseInt(a),0==a%400||0!=a%100&&0==a%4}static daysInMonth(a,b){return b=parseInt(b),2==b&&DateUtils.isLeapYear(a)?29:DateUtils.daysInMonthsMap_[b]}}DateUtils.daysInMonthsMap_=[void 0,31,28,31,30,31,30,31,31,30,31,30,31];
function wrapIDBRequest(a,b){return new Promise((c,d)=>{if(a.onsuccess=()=>c(a.result),a.onerror=d,b)for(const[c,d]of Object.entries(b))a.addEventListener(c,d)})}class Settings{constructor(a,b){this.component_=a,this.initPromise=window.indexedDB&&window.IDBKeyRange&&window.IDBKeyRange.lowerBound(0).includes&&'localStorage'!=b?wrapIDBRequest(indexedDB.open(Settings.DB_NAME,2),{upgradeneeded:(a)=>{this.db_=a.target.result,1>a.oldVersion&&this.db_.createObjectStore(Settings.OBJECT_STORE_NAME,{keyPath:['component','key']}),2>a.oldVersion&&a.target.transaction.objectStore(Settings.OBJECT_STORE_NAME).createIndex('component','component',{unique:!1})}}).then((a)=>(this.db_=a,'indexedDB')):window.localStorage?Promise.resolve('localStorage'):Promise.reject('No storage APIs are supported by this browser.')}get(a,b){let c=[],d={},e=!1;if('string'==typeof a||'number'==typeof a||'boolean'==typeof a)c=[a.toString()],e=!0;else if('object'==typeof a&&a instanceof Array)c=a;else if('object'==typeof a)c=Object.keys(a),d=a;else if(a!=void 0)return Promise.reject('Invalid argument.');if(this.db_){let f=this.db_.transaction(Settings.OBJECT_STORE_NAME).objectStore(Settings.OBJECT_STORE_NAME);return 0==c.length?new Promise((a,b)=>{let c=f.index('component').openCursor(this.component_);c.onsuccess=(b)=>{let c=b.target.result;c?(d[c.value.key]=c.value.value,c.continue()):a(d)},c.onerror=b}):Promise.all(c.map((a)=>wrapIDBRequest(f.get([this.component_,a])))).then((f)=>{for(let a=0;a<c.length;++a)void 0===f[a]&&b&&b[c[a]]?d[c[a]]=b[c[a]]:void 0!=f[a]&&(d[c[a]]=f[a].value);return e?d[a]:d})}if(window.localStorage){let f=this.getLocalStorageKeyPrefix_();if(0==c.length)for(let a,b=0;b<localStorage.length;++b)a=localStorage.key(b),a.substr(0,f.length)==f&&c.push(a.substr(f.length));return c.forEach((a)=>{let c=localStorage.getItem(f+a);null===c&&b&&b[a]?d[a]=b[a]:null!==c&&(d[a]=this.deserializeValue_(c))}),e?Promise.resolve(d[a]):Promise.resolve(d)}}set(a,b){let c={};if('string'==typeof a||'number'==typeof a||'boolean'==typeof a)c[a.toString()]=b;else if('object'==typeof a&&a instanceof Array){if(!b||a.length!=b.length)return Promise.reject('Invalid argument. If |key| is an Array, |value| must be an Array with the same length.');for(let d=0;d<a.length;++d)c[a[d]]=b[d]}else if(a&&'object'==typeof a)c=a;else return Promise.reject('Invalid argument.');if(this.db_){let a=this.db_.transaction(Settings.OBJECT_STORE_NAME,'readwrite');return Promise.all(Object.keys(c).map((b)=>wrapIDBRequest(a.objectStore(Settings.OBJECT_STORE_NAME).put({component:this.component_,key:b,value:c[b]}))))}if(window.localStorage){for(const[a,b]of Object.entries(c))localStorage.setItem(this.getLocalStorageKeyPrefix_()+a,this.serializeValue_(b));return Promise.resolve()}}remove(a){let b=[];if('string'==typeof a||'number'==typeof a||'boolean'==typeof a)b=[a.toString()];else if('object'==typeof a&&a instanceof Array)b=a;else return Promise.reject('Invalid argument.');if(this.db_){if(0==b.length)return Promise.resolve();let a=this.db_.transaction(Settings.OBJECT_STORE_NAME,'readwrite'),c=[];return Promise.all(b.map((b)=>wrapIDBRequest(a.objectStore(Settings.OBJECT_STORE_NAME).delete([this.component_,b])).then(()=>c.push(b)))).then(()=>c)}return window.localStorage?(b.forEach((a)=>localStorage.removeItem(a)),Promise.resolve()):void 0}getLocalStorageKeyPrefix_(){return Settings.LOCAL_STORAGE_PREFIX+this.component_+'.'}serializeValue_(a){return JSON.stringify(a)}deserializeValue_(a){return JSON.parse(a)}}Settings.DB_NAME='_settings',Settings.OBJECT_STORE_NAME='_settings',Settings.LOCAL_STORAGE_PREFIX='_settings.';
function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d('next',a)},function(a){d('throw',a)})}return d('next')})}}class ManifestLoader{constructor(){this.loadedExtraManifests_={}}loadManifest(){return this.manifest?Promise.resolve(this.manifest):fetch('manifest.json').then((a)=>(window.TextDecoder&&a.body&&a.body.getReader&&(this.fetchSupportsReadableStream=!0),a.headers.get('X-Service-Worker-Fallback')&&(this.offline=!0),a.json())).then((a)=>(['archives','line_name_map','line_name_prefix_map','line_name_suffix_map','line_name_suffix_order','unrelated_lines'].forEach((b)=>{a[b]&&(a[b+'_DEPRECATED']=a[b],delete a[b])}),['sources'].forEach((b)=>{let c=b+'_NEW';a[c]&&(a[b]=a[c],delete a[c])}),this.manifest=a,a))}loadExtraManifest_(a){return this.loadedExtraManifests_[a]?Promise.resolve(this.manifest):fetch(a).then((a)=>a.json()).then((b)=>Object.assign(this.manifest,this.loadedExtraManifests_[a]=b))}loadArchives(){return this.loadExtraManifest_('manifest_archives.json')}loadExtra(){return this.loadExtraManifest_('manifest_extra.json')}}class LineDataManager{constructor(){this.manifestLoader=new ManifestLoader,this.loadedLineData_={},this.lineData_={},this.linesByGroup_={},this.lineGroupMap_={},this.lineDisplayNameMap_={}}initAsync(){return this.manifestLoader.loadManifest().then((a)=>{this.manifest=a,this.manifestLoader.offline&&(this.offline=this.manifestLoader.offline),this.fetchSupportsReadableStream_=this.manifestLoader.fetchSupportsReadableStream,this.latestDate=this.manifest.last_update_time.substring(0,10),this.manifest.default_enabled_line_groups&&(this.enabledGroups=this.manifest.default_enabled_line_groups),this.initializeLineNameMap_()})}initializeLineNameMap_(){this.lineNameMap_={};let a={};this.manifest.sources.forEach((b)=>{this.lineNameMap_[b]={},this.manifest.lines[b]&&this.manifest.lines[b].forEach((c)=>{if('__+BEGIN_LINES+__'!=c&&'__+END_LINES+__'!=c&&a[c]){let d;for(d=2;a[c+'_'+d];++d);a[c+'_'+d]=!0,this.lineNameMap_[b][c]=c+'_'+d}else a[c]=!0})})}appendLineDataToLoad_(a,b,c){return'string'==typeof c?c=[c]:void 0==c&&(c=this.manifest.sources),this.enabledGroups&&!this.enabledGroups.includes('*')&&(c=c.filter((a)=>this.enabledGroups.includes(this.manifest.line_group_map[a]||''))),Array.prototype.push.apply(a,c.filter((a)=>!this.loadedLineData_[b]||!this.loadedLineData_[b][a]).map((a)=>'current'==b?{month:b,source:a,sizeHint:this.manifest.size_hints[a]}:this.manifest.archives[a]&&this.manifest.archives[a].lengths?{month:b,source:a,lengthTotal:this.manifest.archives[a].lengths[b],lengthAccurate:!0}:{month:b,source:a})),a}isRangeOverlapped_(a,b,c,d){return a<=d&&b>=c}getDataToLoad_(a,b){let c=[];if(this.isRangeOverlapped_(a,b,this.manifest.start_date,this.latestDate)&&this.appendLineDataToLoad_(c,'current'),a<this.manifest.start_date&&(a<this.earliestDate&&(a=this.earliestDate),b>=this.manifest.start_date&&(b=DateUtils.yesterday(this.manifest.start_date)),a<=b)){let d=Object.keys(this.manifest.archives||{}).map((a)=>{let b=Object.assign({},this.manifest.archives[a],{name:a});return b.start_month=DateUtils.toYearMonth(b.start_date),b.end_month=DateUtils.toYearMonth(b.end_date),b}).filter((c)=>this.isRangeOverlapped_(a,b,c.start_date,c.end_date));for(let e=DateUtils.toYearMonth(a);e<=DateUtils.toYearMonth(b);e=DateUtils.nextMonth(e))this.appendLineDataToLoad_(c,e,d.filter((a)=>e>=a.start_month&&e<=a.end_month).map((a)=>a.name))}return c}load(a,b){var c=this;return _asyncToGenerator(function*(){a<c.manifest.start_date&&(yield c.manifestLoader.loadArchives().then(function(a){c.earliestDate=Object.keys(a.archives||{}).map(function(b){return a.archives[b].start_date}).concat([c.manifest.start_date]).reduce(function(a,b){return b<a?b:a},'9999-99-99')}));let d=c.getDataToLoad_(a,b);for(let a of d){let b,e=a.lengthTotal||0,f=!0,g=a.month.replace('-','')+'.json';b='current'==a.month?c.manifest.data[a.source]:c.manifest.archives[a.source].path+g,yield fetch(b).then((()=>{var b=_asyncToGenerator(function*(b){if(window.TextDecoder&&b.body&&b.body.getReader){if(!e){let a=b.headers.get('Content-Encoding'),d=b.headers.get('Content-Length');(!a||'identity'==a)&&d?e=d:'gzip'==a&&d&&(e=d/(c.manifest.gzip_ratio_hint||.5),f=!1)}if(e){a.lengthTotal=e,a.lengthAccurate=f,a.lengthLoaded=0;let g=b.body.getReader(),h=!1,i=new TextDecoder,j='';for(;!h;)yield g.read().then(function(b){b.done&&(h=!0),b.value&&(j+=i.decode(b.value,{stream:b.done}),a.lengthLoaded+=b.value.length,c.onUpdateProgress&&c.onUpdateProgress(d,a))});return JSON.parse(j)}}return b.json()});return function(){return b.apply(this,arguments)}})()).then(function(b){c.loadedLineData_[a.month]||(c.loadedLineData_[a.month]={}),c.loadedLineData_[a.month][a.source]=b,c.importData_(a.month,a.source),a.loaded=!0,c.onUpdateProgress&&c.onUpdateProgress(d,a)}).catch(function(){return a.loaded=!1},Promise.resolve())}return d})()}importData_(a,b){let c=(this.manifest.line_group_map||{})[b]||'',d=(this.manifest.line_groups||{})[c]||{},e=this.loadedLineData_[a][b];Object.keys(e).forEach((f)=>{let g=this.lineNameMap_[b][f]||f;if(g=this.formatInternalLineName_(g,d),this.lineData_[g]||(this.lineData_[g]={}),this.lineData_[g][a]=e[f],this.lineGroupMap_[g]=c,!this.linesByGroup_[c])this.linesByGroup_[c]=new Set([g]);else{if(this.linesByGroup_[c].has(g))return;this.linesByGroup_[c].add(g)}this.cachedLines_=null})}isDataLoaded(a,b){return(!(a<this.manifest.start_date)||this.earliestDate)&&0==this.getDataToLoad_(a,b).length}getMonthsByRange_(a,b){return Object.keys(this.loadedLineData_).filter((c)=>'current'==c?this.isRangeOverlapped_(a,b,this.manifest.start_date,this.latestDate):DateUtils.toYearMonth(a)<=c&&DateUtils.toYearMonth(b)>=c)}queryLines(a,b,c){'string'==typeof a&&(a=[a]);let d={},e={};a.forEach((f,g)=>{this.getMonthsByRange_(b,c).sort().forEach((h)=>{let j=this.lineData_[f][h];j&&(j.buses.forEach((a)=>{d[a.licenseId]?d[a.licenseId].busId!=a.busId&&(d[a.licenseId].busId=a.busId):d[a.licenseId]=Object.assign({},a)}),j.details.filter((a)=>a[0]>=b&&a[0]<=c).forEach((b)=>{e[b[0]]||(e[b[0]]={});for(let c,f=0;f<j.buses.length;++f){c=j.buses[f].licenseId,e[b[0]][c]||(e[b[0]][c]=Array(a.length).fill(0));let h=b[1][f];e[b[0]][c][g]=h,0<h&&(d[c].hasWeight=!0)}}))})});let f=this.sortBuses_(Object.keys(d).filter((a)=>d[a].hasWeight).map((a)=>d[a])),g=Array(a.length).fill(0),h=Object.keys(e).sort().map((a)=>[a,f.map((b)=>e[a][b.licenseId]||g)]);return{buses:f,details:h}}containsLines(a){return'string'==typeof a&&(a=[a]),!a.some((a)=>!this.lineData_[a])}queryBuses(a,b,c,d){let e=new Set,f={},g={};(a.lines||Object.keys(this.lineData_)).forEach((h)=>{this.getMonthsByRange_(b,c).sort().forEach((i)=>{let j=this.lineData_[h][i],k=null;j&&j.buses.forEach((i,l)=>{if(this.compareBus_(i,a)){f[i.licenseId]?f[i.licenseId].busId!=i.busId&&(f[i.licenseId].busId=i.busId):f[i.licenseId]=Object.assign({},i),k||(k=j.details.filter((a)=>a[0]>=b&&a[0]<=c));for(let a of k){g[a[0]]||(g[a[0]]={});let b=a[1][l];if(0<b&&(g[a[0]][i.licenseId]||(g[a[0]][i.licenseId]={}),g[a[0]][i.licenseId][h]=b,e.add(h),!d))break}}})})});let h=this.sortLines_(Array.from(e));if(!d)return{lines:h};let i=this.sortBuses_(Object.keys(f).map((a)=>f[a])),j=Object.keys(g).sort().map((a)=>[a,i.map((b)=>h.map((c)=>(g[a][b.licenseId]||{})[c]||0))]);return{lines:h,buses:i,details:j}}getLineFullName(a){return this.lineData_[a]?a:Object.keys(this.lineData_).find((b)=>b.substring(0,b.indexOf('_'))==a)}queryCurrentBus(a,b){let c=this.lineData_[this.getLineFullName(a)];if(c)return c.current.buses.find((a)=>a.licenseId==b)}hasBusId(a){'string'==typeof a&&(a=[a]);for(let b of a){let a=this.manifest.line_groups&&this.manifest.line_groups[this.lineGroupMap_[b]]||this.manifest;if(!1!==a.has_bus_id)return!0}return!1}compareBus_(a,b){let c=!1;return['busId','licenseId'].forEach((d)=>{b[d]&&(c|=b[d].some((b)=>'string'==typeof b?a[d]==b:b.start&&b.end?a[d]>=b.start&&a[d]<=b.end:b.prefix?a[d].substr(0,b.prefix.length)==b.prefix:b.suffix?a[d].substr(-b.suffix.length)==b.suffix:void 0))}),c}getLines(){const a=/^([^0-9]*[0-9]+)([^_]*)(.*)$/;return this.cachedLines_?this.cachedLines_:this.cachedLines_=this.getGroups().map((b)=>{let c=(this.manifest.line_groups||{})[b.id]||this.manifest,d=Object.assign({},b,{rawLines:this.sortLines_(Array.from(this.linesByGroup_[b.id]),c),lines:[]}),e=c.unrelated_lines||[],f=c.related_lines||[];c.namespace&&(f=f.map((a)=>a.map((a)=>c.namespace+':'+a).filter((a)=>d.rawLines.includes(a))).filter((a)=>1<a.length));let g={};f.forEach((a)=>a.forEach((b)=>g[b]=a));let h=new Set,i=null;return d.rawLines.forEach((b)=>{if(!h.has(b)){if(g[b]){let a=g[b];return a.forEach((a)=>h.add(a)),void d.lines.push({idlist:a,displayName:this.getLineDisplayName(a[0])})}let c=a.exec(b);if(i&&c&&i[1]==c[1]&&i[3]==c[3]&&!e.includes(c[1]+c[2])){let a=d.lines[d.lines.length-1];if(!a.idlist){a.idlist=[a.id],delete a.id;let c=0,d=this.getLineDisplayName(b);for(;a.displayName[c]&&a.displayName[c]==d[c];)++c;a.displayName=d.substring(0,c),'\uFF08'==a.displayName.slice(-1)?a.displayName=a.displayName.slice(0,-1):'\u8DEF'==d.slice(-1)&&'\u8DEF'!=a.displayName.slice(-1)&&(a.displayName+='\u8DEF')}a.idlist.push(b)}else d.lines.push({id:b,displayName:this.getLineDisplayName(b)});i=c}}),d})}getLineCount(){return this.getLines().reduce((a,b)=>a+b.lines.length,0)}sortLines_(a,c){return c||(c={}),a.sort((d,e)=>{const f=/^[0-9]+$/,g=/^([^:]*:)?([A-Z]*)([0-9]*)([A-Z]*)(?:_([0-9]+))?$/;if(c.line_name_map&&(c.line_name_map[d]&&(d=c.line_name_map[d]),c.line_name_map[e]&&(e=c.line_name_map[e])),f.test(d)&&f.test(e))return this.compareNumbers_(d,e);d={full:d},e={full:e},[d,e].forEach((a)=>{let b=g.exec(a.full);b&&b[0]?(b[1]&&(a.namespacePrefix=b[1]),b[2]&&(a.prefixAlpha=b[2]),b[3]&&(a.numberPart=b[3]),b[4]&&(a.suffixAlpha=b[4]),b[5]&&(a.copyNumber=b[5])):a.other=!0});let h=this.compareWithoutCopyNumber_(d,e,c);return 0==h?this.compareNumbers_(d.copyNumber||-1,e.copyNumber||-1,'natural'):h})}compareWithoutCopyNumber_(c,a,b){if(c.other&&a.other)return this.defaultCompare_(c,a);if(c.other&&!a.other)return 1;if(!c.other&&a.other)return-1;if(c.prefixAlpha&&!a.prefixAlpha)return 1;if(!c.prefixAlpha&&a.prefixAlpha)return-1;if(c.numberPart&&!a.numberPart)return-1;if(!c.numberPart&&a.numberPart)return 1;if(c.prefixAlpha&&a.prefixAlpha&&(!c.numberPart&&!a.numberPart||c.prefixAlpha!=a.prefixAlpha))return this.defaultCompare_(c.prefixAlpha,a.prefixAlpha);let d=this.compareNumbers_(c.numberPart,a.numberPart);if(0==d){let d=[void 0].concat(b.line_name_suffix_order||[]);return[c.suffixAlpha,a.suffixAlpha].sort().forEach((a)=>!d.includes(a)&&d.push(a)),this.defaultCompare_(d.indexOf(c.suffixAlpha),d.indexOf(a.suffixAlpha))}return d}compareNumbers_(c,d,e){let f='plain'==(e||this.linesSortOrder);return f&&('number'==!typeof c||'number'==!typeof d)?(c=c.toString(),d=d.toString()):!f&&('string'==typeof c||'string'==typeof d)&&(c=parseInt(c),d=parseInt(d)),this.defaultCompare_(c,d)}defaultCompare_(c,a){return c<a?-1:c>a?1:0}sortBuses_(a){return a.sort((c,a)=>{if(c.busId&&a.busId)return c.busId<a.busId?-1:c.busId>a.busId?1:0;if(c.busId&&!a.busId)return-1;if(!c.busId&&a.busId)return 1;if(c.licenseId.length>a.licenseId.length)return 1;if(c.licenseId.length<a.licenseId.length)return-1;if(6==c.licenseId.length){let b=this.defaultCompare_(c.licenseId[5],a.licenseId[5]);if(0!=b)return b}return this.defaultCompare_(c.licenseId,a.licenseId)})}getGroups(){let c=[''].concat(this.manifest.line_group_order||[]);return Object.keys(this.linesByGroup_).sort((d,a)=>{let b=c.indexOf(d),e=c.indexOf(a);return-1!=b&&-1!=e?b-e:-1==b&&-1!=e?1:-1!=b&&-1==e?-1:this.defaultCompare_(d,a)}).map((a)=>({id:a,displayName:(this.manifest.line_groups[a]||{}).name||a}))}getLineDisplayName(a,b){let c=this.lineGroupMap_[a];if(a=this.lineDisplayNameMap_[a]||a,b||(b=this.manifest.line_groups&&this.manifest.line_groups[c]||this.manifest),b.line_name_map&&b.line_name_map[a])return this.getLineDisplayName(b.line_name_map[a],b);let d=/^([^0-9]*)([0-9]+)([^0-9_]*)(.*)$/.exec(a);if(d){if(d[1]&&b.line_name_prefix_map&&b.line_name_prefix_map[d[1]]){let a=b.line_name_prefix_map[d[1]];'string'==typeof a?d[1]=a:(d[1]=a[0],d[2]+=a[1])}return d[3]&&b.line_name_suffix_map&&b.line_name_suffix_map[d[3]]&&(d[3]='\uFF08'+b.line_name_suffix_map[d[3]]+'\uFF09'),d[1]+d[2]+d[3]+d[4]}return a}formatInternalLineName_(a,b){let c=b||this.manifest,d=a;if(c.line_name_reverse_map&&c.line_name_reverse_map[d])d=c.line_name_reverse_map[d];else{for(let[a,b]of Object.entries(c.line_name_prefix_reverse_map||{}))if(d.substring(0,a.length)==a){d=b+d.substring(a.length);break}for(let[a,b]of Object.entries(c.line_name_suffix_reverse_map||{}))if(d.slice(-a.length)==a){d=d.slice(0,-a.length)+b;break}}let e=d;return b.namespace&&(e=b.namespace+':'+e),e!=a&&(b.line_name_map&&b.line_name_map[d]&&(a=b.line_name_map[d]),this.lineDisplayNameMap_[e]=a),e}getLastUpdateTime(){return this.manifest.last_update_time}}class HolidayParser{constructor(a){this.holidays=a.special_holidays}isHoliday(a){if(!this.holidays)return!1;let b=a.indexOf('-');if(-1==b)return!1;let c=a.substring(0,b),d=a.substring(b+1);if(this.holidays.fixed_holidays_years&&c>=this.holidays.fixed_holidays_years[0]&&(!this.holidays.fixed_holidays_years[1]||c<=this.holidays.fixed_holidays_years[1])&&this.inDateList_(d,this.holidays.fixed_holidays))return!0;if(this.inDateList_(a,this.holidays.holidays||[]))return!0;let e=new Date(a).getUTCDay();return(0==e||6==e)&&!this.inDateList_(a,this.holidays.workdays||{})}inDateList_(a,b){for(let c of b)if('string'==typeof c){if(a==c)return!0;}else if(a>=c[0]&&(!c[1]||a<=c[1]))return!0;return!1}}const COLOR=[95,140,181],COLOR_GREY=[160,160,160],PALETTE=[[230,25,75],[60,180,75],[255,225,25],[0,130,200],[245,130,48],[145,30,180],[70,240,240],[240,50,230],[210,245,60],[250,190,190],[0,128,128],[170,110,40],[128,0,0],[170,255,195],[128,128,0],[0,0,128]],NBSP='\xA0',DEFAULT_DATE_RANGE=30,DATE_HOLIDAY_CLASS='date_holiday';let currentStartDate,currentEndDate,lineDataManager=new LineDataManager,settings=new Settings('buses'),holidayParser=null,extraManifestLoading=!1,essentialSettings={},progressText='',activeLines=[];function positionPopup(a,b,c,d,e,f){var g=Math.min;d||(d=0),e||0===e||(e=d);let h=a.offsetWidth||a.clientWidth,i=a.offsetHeight||a.clientHeight,j=g(b,window.innerWidth&&h?window.innerWidth-h-d:b),k=g(c,window.innerHeight&&i?window.innerHeight-i-e:c);f&&(j+=document.body.scrollLeft+document.documentElement.scrollLeft,k+=document.body.scrollTop+document.documentElement.scrollTop),a.style.left=j.toString()+'px',a.style.top=k.toString()+'px'}function loadBusUpdates(){let a=document.getElementById('updates');return 0<a.children.length?Promise.resolve():fetch('newbuses.csv').then((a)=>a.text()).then((b)=>{let c=b.split(/\r\n|\r|\n/).filter((a)=>!a.match(/^\s*$/)).map((a)=>{let b=a.split(',');return{update_time:b[0],line:b[1],licenseId:b[2]}}).reverse();c.splice(20),replaceChildren(a,createElement('table',[createElement('thead',createElement('tr',['\u65F6\u95F4','\u7EBF\u8DEF','\u81EA\u7F16\u53F7','\u8F66\u724C\u53F7'].map((a)=>createElement('th',a)))),createElement('tbody',c.map((a)=>{let b=convertLineName(a.line,lineDataManager.manifest),c=b.match(/（|\(/);c&&(b=[createElement('span',b.substring(0,c.index)),createElement('span',b.substring(c.index),{className:'a_small_note'})]);let d=([].find.call(document.getElementById('lineChooser').querySelectorAll('option'),(b)=>b.value.split('+').includes(a.line))||{}).value||lineDataManager.getLineFullName(a.line);return createElement('tr',[createElement('td',a.update_time.substring(5)),createElement('td',createElement('a',b,{href:'#'+d})),createElement('td',(lineDataManager.queryCurrentBus(a.line,a.licenseId)||{}).busId||''),createElement('td',a.licenseId)])}))]))})}function isBusIdContinuous(c,a){if(c.substr(0,2)!=a.substr(0,2))return!1;var b=parseInt(c.substr(2)),d=parseInt(a.substr(2));if(b==d+1||d==b+1)return!0;return!('5-'!=c.substr(0,2)||(3!=b%10||b+2!=d)&&(3!=d%10||d+2!=b))}function convertLineName(a,b){if(b.line_name_map&&b.line_name_map[a])return convertLineName(b.line_name_map[a],b);let c=/^([^0-9]*)([0-9]+)([^0-9_]*)(.*)$/.exec(a);if(c){if(c[1]&&b.line_name_prefix_map&&b.line_name_prefix_map[c[1]]){let a=b.line_name_prefix_map[c[1]];'string'==typeof a?c[1]=a:(c[1]=a[0],c[2]+=a[1])}return c[3]&&b.line_name_suffix_map&&b.line_name_suffix_map[c[3]]&&(c[3]='\uFF08'+b.line_name_suffix_map[c[3]]+'\uFF09'),c[1]+c[2]+c[3]+c[4]}return a}function updateLineChooser(a){let b=document.getElementById('lineChooser'),c=b.value;a=a.map((a)=>Object.assign({},a,{options:a.lines.map((a)=>createElement('option',a.displayName,{value:a.id||a.idlist.join('+')}))}));let d=a.filter((a)=>!a.id).map((a)=>a.options).reduce((a,b)=>a.concat(b),[]),e=a.filter((a)=>a.id);replaceChildren(b,[...d,...e.map((a)=>createElement('optgroup',a.options,{label:a.displayName}))]),c&&(b.value=c)}function createTableHeader(a,b){!1!==b&&(b=!0);let c=[];if(b){c=a.map((a)=>createElement('th',a.busId));let b=0,d=!1,e='';for(let f=!1;b<a.length;++b)e=f?'busid_odd_range_element':'busid_even_range_element',0<b&&isBusIdContinuous(a[b-1].busId,a[b].busId)?d?c[b-1].className=e:(c[b-1].className='busid_range_begin '+e,d=!0):d&&(d=!1,c[b-1].className='busid_range_end '+e,f=!f);d&&(c[b-1].className='busid_range_end '+e)}return createElement('thead',[...(b?[createElement('tr',[createElement('th','\u81EA\u7F16\u53F7'),...c])]:[]),createElement('tr',['\u8F66\u724C\u53F7'].concat(a.map((a)=>a.licenseId)).map((a)=>createElement('th',a)))])}function convertBusQuery(a){const b=/^([0-9])(?:0|-)([0-9]{4})$/,c=/^([0-9])(?:0|-)([0-9]{4})(?:~|～)([0-9])(?:0|-)([0-9]{4})$/,d=/^(?:苏\s*E[^0-9A-Z]{0,4})?([0-9A-Z]{5}|[0-9]{5}(?:D|F))$/i,e=/^(?:苏\s*E[^0-9A-Z]{0,4})?([0-9A-Z]{5}|[0-9]{5}(?:D|F))(?:~|～)(?:苏\s*E[^0-9A-Z]{0,4})?([0-9A-Z]{5}|[0-9]{5}(?:D|F))$/i,f=/^([^~～*?#]+)(?:\*|\?|#){1,3}$/;let g={busId:[],licenseId:[]},h=a.split(/,|;|，|；|、|\s+/);return h.forEach((a)=>{let h=null;(h=c.exec(a))?g.busId.push({start:h[1]+'-'+h[2],end:h[3]+'-'+h[4]}):(h=e.exec(a))?g.licenseId.push({start:h[1].toUpperCase(),end:h[2].toUpperCase()}):(h=f.exec(a))?h[1].includes('-')?g.busId.push({prefix:h[1]}):g.licenseId.push({prefix:h[1].toUpperCase()}):(h=b.exec(a))?g.busId.push(h[1]+'-'+h[2]):(h=d.exec(a))?g.licenseId.push(h[1].toUpperCase()):'*'==a[0]&&g.licenseId.push({suffix:a.substr(1)})}),g}function findBusByQuery(a){let b=document.getElementById('bus_count_container'),c=document.getElementById('bus_count'),d=lineDataManager.queryBuses(convertBusQuery(a),currentStartDate,currentEndDate,!0);fillSelect(document.getElementById('resultList'),d.lines),0<d.lines.length?(c.innerText=d.buses.length,b.style.display=''):b.style.display='none'}function showLinesNew(a,b,c){if('string'==typeof a&&(a=[a]),a.length>PALETTE.length&&!c)return void replaceChildren('content','\u60A8\u9009\u62E9\u7684\u7EBF\u8DEF\u592A\u591A\u4E86\uFF01');if(!b&&!lineDataManager.containsLines(a))return void replaceChildren('content','\u67D0\u4E9B\u7EBF\u8DEF\u4E0D\u5B58\u5728\uFF01');let d=DateUtils.tomorrow(lineDataManager.getLastUpdateTime().substring(0,10));removeChildren('legend'),1<a.length&&appendChildren('legend',a.map((a,b)=>createElement('span',[createElement('span',null,{style:{backgroundColor:'rgb('+PALETTE[b%PALETTE.length].join(',')+')',height:'1em',width:'2em',display:'inline-block',marginLeft:'3em'}}),' '+lineDataManager.getLineDisplayName(a)])));let e=b||lineDataManager.queryLines(a,currentStartDate,currentEndDate);replaceChildren('content',createElement('table',[createTableHeader(e.buses,lineDataManager.hasBusId(a)),createElement('tbody',e.details.map((b,f)=>createElement('tr',[createElement('th',b[0],{className:'date'+(essentialSettings.annotateHolidays&&holidayParser&&holidayParser.isHoliday(b[0])?' '+DATE_HOLIDAY_CLASS:'')+(essentialSettings.annotateIncontinuousDate&&DateUtils.tomorrow(b[0])!=(e.details[f+1]||[d])[0]?' date_incontinuous_below':'')}),...e.buses.map((d,e)=>{let f=b[1][e].filter((a)=>0<a).length;if(0==f)return createElement('td',c?[createElement('span',NBSP,{className:'line_view_bus_item',style:{width:'100%',backgroundColor:'rgb('+COLOR_GREY.join(',')+')'}})]:null);let g=createElement('td'),h=!0;return b[1][e].forEach((b,d)=>{if(0<b){let e=a[d];h?h=!1:e='/'+e,g.appendChild(createElement('span',c?e:NBSP,{className:'line_view_bus_item',style:Object.assign({width:100/f+'%',backgroundColor:c?'rgb('+COLOR_GREY.map((a)=>parseInt((255-a)*b+a)).join(',')+')':'rgb('+(1==a.length?COLOR:PALETTE[d]).map((a)=>parseInt((255-a)*(1-b)+a)).join(',')+')'},c?{color:'rgb('+PALETTE[d%PALETTE.length],fontWeight:'bold'}:null),"data-line":a[d]}))}}),g})])))])),!essentialSettings.annotateHolidays||holidayParser||extraManifestLoading||(extraManifestLoading=!0,lineDataManager.manifestLoader.loadExtra().then((a)=>{holidayParser=new HolidayParser(a);for(let b of document.querySelectorAll('#content th.date'))!b.className.split(' ').includes(DATE_HOLIDAY_CLASS)&&holidayParser.isHoliday(b.innerText||b.textContent)&&(b.className+=' '+DATE_HOLIDAY_CLASS)}))}function onChooseLine(){let a=this.value.split('+'),b=!1;document.getElementById('compare').checked?a.forEach((a)=>!activeLines.includes(a)&&(activeLines.push(a),b=!0)):(activeLines=a,b=!0),b&&(showLinesNew(activeLines),history.pushState(1==activeLines.length?activeLines[0]:activeLines,'','#'+activeLines.join('+')))}function parseUrlHash(){if(location.hash.replace('#','')){var a=location.hash.replace('#','');return activeLines=a.split('+'),lineChooser.value=a,lineDataManager&&currentStartDate&&showLinesNew(activeLines),!0}}function onModifyDate(){if(!lineDataManager)return;let a=document.getElementById('startDate'),b=document.getElementById('endDate');if(lineDataManager.earliestDate&&a.value<lineDataManager.earliestDate&&(a.value=lineDataManager.earliestDate),b.value>lineDataManager.latestDate&&(b.value=lineDataManager.latestDate),currentStartDate==a.value&&currentEndDate==b.value)a.value=currentStartDate,b.value=currentEndDate;else if(currentStartDate=a.value,currentEndDate=b.value,lineDataManager.isDataLoaded(currentStartDate,currentEndDate))showLinesNew(activeLines);else{let b=document.getElementById('progress');document.getElementById('progressbar').style.width=0,document.getElementById('progress_text').innerText=progressText,b.style.display='',lineDataManager.load(currentStartDate,currentEndDate).then(()=>{b.style.display='none',updateLineChooser(lineDataManager.getLines()),showLinesNew(activeLines),lineDataManager.earliestDate&&a.value<lineDataManager.earliestDate&&(a.value=lineDataManager.earliestDate)})}}function navigateLine(a,b){let c=document.getElementById('lineChooser'),d=Math.max(0,c.selectedIndex+a),e=lineDataManager.getLineCount();0<e&&d>e-1&&(d=e-1),c.selectedIndex=d,b||onChooseLine.call(c)}function init(){let a=initLineData(),b=settings.initPromise.then(()=>settings.get({enabledGroups:[],annotateHolidays:!0,annotateIncontinuousDate:!0}).then((a)=>essentialSettings=a)).catch(()=>{});initEvents(),Promise.all([a,b]).then(()=>{initEvents2(),essentialSettings.enabledGroups&&essentialSettings.enabledGroups.length&&(lineDataManager.enabledGroups=essentialSettings.enabledGroups),lineDataManager.load(currentStartDate,currentEndDate).then(()=>{document.getElementById('progress').style.display='none',updateLineChooser(lineDataManager.getLines()),parseUrlHash()||(activeLines=[lineChooser.querySelector('option').value],showLinesNew(activeLines))})})}function initLineData(){let a=document.getElementById('lineChooser'),b=document.getElementById('offline_prompt');return lineDataManager.initAsync().then(()=>{lineDataManager.offline&&(b.style.display=''),document.getElementById('last_update_container').style.display='',replaceChildren('last_update_time',lineDataManager.getLastUpdateTime()),currentEndDate=lineDataManager.latestDate;let a=new Date(currentEndDate);a.setDate(a.getDate()-DEFAULT_DATE_RANGE+1),currentStartDate=a.toISOString().substring(0,10),document.getElementById('startDate').value=currentStartDate,document.getElementById('endDate').value=currentEndDate,progressText=document.getElementById('progress_text').innerText,lineDataManager.onUpdateProgress=function(a){let b=document.getElementById('progressbar'),c=a.filter((a)=>a.sizeHint),d=c.reduce((a,b)=>a+=b.sizeHint,0),e=c.reduce((a,b)=>{let c=b.sizeHint/d;return b.loaded?a+=c:b.lengthLoaded&&b.lengthTotal&&(b.lengthAccurate?a+=c*b.lengthLoaded/b.lengthTotal:a+=c*Math.min(b.lengthLoaded,.95*b.lengthTotal)/b.lengthTotal),a},0),f=a.filter((a)=>a.lengthAccurate&&!a.sizeHint),g=f.reduce((a,b)=>a+b.lengthTotal,0),h=f.reduce((a,b)=>{let c=b.lengthTotal/g;return b.loaded?a+=c:b.lengthLoaded&&(a+=c*b.lengthLoaded/b.lengthTotal),a},0),i=100*(e*c.length/a.length+h*f.length/a.length);b.style.width=i+'%',document.getElementById('progress_text').innerText=progressText+Math.round(i)+'%'}}).catch(()=>(replaceChildren(b,'\u6570\u636E\u52A0\u8F7D\u5931\u8D25\uFF0C\u8BF7\u68C0\u67E5\u60A8\u7684\u7F51\u7EDC\u72B6\u6001\u3002'),b.style.display='',Promise.reject()))}function initEvents(){function a(a,b,c){var d=document.getElementById('cellDetails');if('none'!=d.style.display){var e=document.getElementById('cellLineContainer'),f=a;'span'==f.tagName.toLowerCase()?(f=f.parentElement,e.style.display='',document.getElementById('cellLine').innerText=a.getAttribute('data-line')):e.style.display='none',document.getElementById('cellDate').innerText=f.parentElement.children[0].innerText;var g=document.getElementById('content').querySelector('table thead');document.getElementById('cellBusId').innerText=g.children[0].children[f.cellIndex].innerText,document.getElementById('cellLicenseId').innerText=g.children[1].children[f.cellIndex].innerText,positionPopup(d,b+8,c+8,30,30,!0)}}function b(){var a=document.getElementById('cellDetails');a.style.display='none'!=a.style.display||document.getElementById('disableInfotip').checked?'none':''}let c=document.getElementById('lineChooser');c.addEventListener('change',onChooseLine),document.getElementById('resultList').addEventListener('change',onChooseLine),window.addEventListener('popstate',function(a){a.state instanceof Array?(activeLines=a.state,showLinesNew(activeLines)):a.state?(activeLines=[a.state],showLinesNew(a.state)):parseUrlHash()}),document.getElementById('bus_query').addEventListener('input',function(){lineDataManager&&currentStartDate&&findBusByQuery(this.value)}),document.getElementById('findDetails').addEventListener('click',function(){if(lineDataManager&&currentStartDate){let a=lineDataManager.queryBuses(Object.assign({lines:[].map.call(document.getElementById('resultList').children,(a)=>a.value)},convertBusQuery(document.getElementById('bus_query').value)),currentStartDate,currentEndDate,!0);showLinesNew(a.lines,a,!0)}}),document.getElementById('content').addEventListener('click',function(c){var d=c.target?c.target.tagName.toLowerCase():'';('span'==d||'td'==d)&&(b(),a(c.target,c.clientX,c.clientY))});var d=!1,f=null;document.getElementById('content').addEventListener('touchstart',function(c){var e=c.target?c.target.tagName.toLowerCase():'';'span'!=e&&'td'!=e||1!=c.touches.length||d||(d=!0,f=window.setTimeout(function(){d&&(b(),a(c.target,c.touches[0].clientX,c.touches[0].clientY),d=!1,f=null)},1500))}),document.getElementById('content').addEventListener('touchmove',function(){d&&(d=!1,window.clearTimeout(f),f=null)}),document.getElementById('content').addEventListener('touchend',function(b){var c=b.target?b.target.tagName.toLowerCase():'';('span'==c||'td'==c&&1==b.touches.length&&d)&&(b.preventDefault(),a(b.target,b.touches[0].clientX,b.touches[0].clientY),d=!1,window.clearTimeout(f),f=null)}),document.getElementById('content').addEventListener('mouseover',function(b){var c=b.target?b.target.tagName.toLowerCase():'';('span'==c||'td'==c)&&a(b.target,b.clientX,b.clientY)}),document.getElementById('last_update_time').addEventListener('click',function(){loadBusUpdates().then(()=>{let a=document.getElementById('updates'),b=document.getElementById('last_update_container');'none'==a.style.display?(a.style.display='',positionPopup(a,b.offsetLeft,b.offsetTop+b.offsetHeight+8,30)):a.style.display='none'})});let g=!1;document.addEventListener('keydown',function(a){(a.altKey||a.ctrlKey||a.shiftKey||a.metaKey)&&(('ArrowUp'==a.key||38==a.keyCode)&&0<c.selectedIndex?(navigateLine(-1,a.repeat),g=a.repeat,a.preventDefault()):('ArrowDown'==a.key||40==a.keyCode)&&(navigateLine(1,a.repeat),g=a.repeat,a.preventDefault()))}),document.addEventListener('keyup',function(){g&&(g=!1,navigateLine(0,!1))})}function initEvents2(){document.getElementById('startDate').addEventListener('change',onModifyDate),document.getElementById('endDate').addEventListener('change',onModifyDate);let a=document.getElementById('disableInfotip');return a.addEventListener('change',()=>{settings.set({disableInfotip:a.checked})}),settings.get({disableInfotip:!1}).then((b)=>{a.checked=!!b.disableInfotip})}(function(){function a(){b||(init(),b=!0)}let b=!1;document.onload=a,document.onreadystatechange=function(){'complete'==document.readyState&&a()},document.addEventListener('DOMContentLoaded',a)})(),'serviceWorker'in navigator&&navigator.serviceWorker.register(location.href.substring(0,location.href.lastIndexOf('/'))+'/service_worker.js');

//# sourceMappingURL=buses.min.js.map</script>
  </head>
  <body>
    <div style="margin-bottom: 1em">
      选择线路：<select id="lineChooser"></select>
      <label><input type="checkbox" id="compare">+ 比较</label>
      <span style="margin-left: 0.6em">
        <input type="date" id="startDate">
        ~
        <input type="date" id="endDate">
      </span>
      <span style="margin-left: 1.2em">
        寻找车辆：<input type="text" id="bus_query" size="20">
        <span id="bus_count_container" style="display:none">
          （共
          <span id="bus_count"></span>
          台）
        </span>
        <select id="resultList"></select>
        <button id="findDetails">
          搜索
        </button>
      </span>
      <label><input type="checkbox" id="disableInfotip">关闭提示</label>
      <span style="margin-left: 1.2em;display:none" id="last_update_container">
        最后更新时间：<a id="last_update_time" href="javascript:void(0)"></a>
      </span>
    </div>
    <div id="progress">
      <span id="progress_text">正在加载，请稍候……</span>
      <div id="progressbar"></div>
    </div>
    <div id="offline_prompt" style="display:none">
      您目前处于离线状态，下方的数据可能不是最新的。
    </div>
    <div id="legend"></div>
    <div id="content"></div>
    <div id="cellDetails" style="display:none">
      日期：<span id="cellDate"></span><br>
      <span id="cellLineContainer" style="display:none">
        线路：<span id="cellLine"></span><br>
      </span>
      自编号：<span id="cellBusId"></span><br>
      车牌号：<span id="cellLicenseId"></span>
    </div>
    <div id="updates" style="display:none"></div>
  </body>
</html>
